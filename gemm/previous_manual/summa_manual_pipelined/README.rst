manual implementation of summa without collectives_2d library/ pipelined version